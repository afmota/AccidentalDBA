<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>DBA Acidental</title>
	<link rel="stylesheet" href="estilo/style.css">
	<link rel="stylesheet" href="estilo/media-queries.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<style>
		ul {
			line-height: 1.5em;
		}

		li.cap {
			margin-top: 10px;
		}

		.cap {
			font-weight: bolder;
			color: black;
		}

		.n1 {
    		margin-left: 25px;
		}

		.n2 {
		    margin-left: 25px;
		}

		main img {
			box-shadow: 8px 8px 15px rgba(0, 0, 0, 0.562);
		}

		main p {
			text-indent: 0px;
		}

		main a {
			text-decoration: none;
			color: black;
			background-color: white;
			font-weight: normal;
		}
	</style>
	<script src="scripts/horas.js"></script>
</head>
<body onresize="mudouTamanho()">
	<header>
		<h1>Troubleshooting SQL Server</h1>
		<h2>Um Guia para o DBA Acidental</h2>	
	</header>

	<nav>
		<i id="burger" class="material-icons" onclick="clickMenu()">menu</i>
		<menu id="itens">
			<ul>
				<li><a href="abertura.html" target="_self">Abertura</a></li>
				<li><a href="introducao.html" target="_self">Introdução</a></li>
				<li><a href="cap01.html" target="_self">Cap.1</a></li>
				<li><a href="cap02.html" target="_self">Cap.2</a></li>
				<li><a href="cap03.html" target="_self">Cap.3</a></li>
				<li><a href="cap04.html" target="_self">Cap.4</a></li>
				<li><a href="cap05.html" target="_self">Cap.5</a></li>
				<li><a href="cap06.html" target="_self">Cap.6</a></li>
			</ul>
		</menu>
	</nav>

	<main>
		<img src="imagens/capa.jpg" class="capa" alt="Capa do livro">

		<p>Troubleshooting SQL Server<br>
			A Guide for the Accidental DBA<br>
			By Jonathan Kehayias and Ted Krueger</p>
		<p>With a Foreword from Paul S. Randal</p>

		<p>First published by Simple Talk Publishing September 2011</p>

		<p>
			Direitos autorais de Jonathan Kehayias e Ted Krueger 2011<br>
			ISBN 978-1-906434-77-9<br>
			O direito de Jonathan Kehayias e Ted Krueger de serem identificados como autores desta obra foi afirmado por eles de acordo com o Copyright, Designs and Patents Act 1988.<br>
			Todos os direitos reservados. Nenhuma parte desta publicação pode ser reproduzida, armazenada ou introduzida em um sistema de recuperação, ou transmitida de qualquer forma ou por qualquer meio (eletrônico, mecânico, fotocópia, gravação ou outro) sem o consentimento prévio por escrito do editor. Qualquer pessoa que realizar qualquer ato não autorizado em relação a esta publicação poderá ser responsabilizada por processo criminal e reivindicações civis por danos. Este livro é vendido sob a condição de que não seja emprestado, revendido, alugado ou circulado de outra forma sem o consentimento prévio do editor, em qualquer forma que não seja a publicada, e sem uma condição semelhante, incluindo esta condição, sendo imposta ao editor subsequente.<br>
			Editado por Tony Davis<br>
			Revisão técnica e material adicional: Gail Shaw<br>
			Imagem da capa por Andy Martin<br>
			Diagramação e design por Matthew Tye & Gower Associates<br>
		</p>

		<h1>Sumário</h1>

		<ul type="disk">
			<li class="cap"><a href="introducao.html" target="_self" class="cap">Introdução</a></li>
			
			<ul class="n1">
				<li><a href="introducao.html#paraquem" target="_self">Para quem é este livro?</a></li>
				<li><a href="introducao.html#exemplos">Exemplos de código</a></li>
			</ul>
			
			<li class="cap"><a href="cap01.html" class="cap">Capítulo 1: Uma metodologia de solução de problemas de desempenho</a></li>
			
			<ul class="n1">
				<li><a href="cap01.html#definindo" target="_self">Definindo uma Metodologia de Solução de Problemas</a></li>
				<li><a href="cap01.html#wait" target="_self">Wait Statistics: a Base para Resolução de Problemas</a></li>
				<li><a href="cap01.html#virtual" target="_self">Virtual File Statistics</a></li>
				<li><a href="cap01.html#contadores" target="_self">Contadores de desempenho</a></li>
				<li><a href="cap01.html#cache" target="_self">Uso do cache de plano</a></li>
				<li><a href="cap01.html#resumo" target="_self">Resumo</a></li>
			</ul>

			<li class="cap"><a href="cap02.html" target="_self" class="cap">Capítulo 2: Configuração de E/S de Disco</a></li>
			
			<ul class="n1">
				<li><a href="cap02.html#consideracoes">Configuração de disco: Considerações Básicas</a></li>

				<ul class="n2">
					<li><a href="cap02.html#tamanho" target="_self">Tamanho do disco vs. throughput do disco</a></li>
					<li><a href="cap02.html#leitura" target="_self">Leitura aleatória versus leitura sequencial</a></li>
				</ul>

				<li><a href="cap02.html#escolha" target="_self">Escolhendo o nível correto de RAID</a></li>

				<ul class="n2">
					<li><a href="cap02.html#visaogeral" target="_self">Uma breve visão geral das configurações RAID</a></li>
					<li><a href="cap02.html#txtransf" target="_self">Considerações sobre o tamanho do disco e taxa de transferência</a></li>
					<li><a href="cap02.html#workload" target="_self">Considerações sobre a carga de trabalho</a></li>
				</ul>

				<li><a href="cap02.html#storage" target="_self">Direct Attached Storage vs. Storage Area Networks</a></li>

				<ul class="n2">
					<li><a href="cap02.html#das" target="_self">Direct Attached Storage</a></li>
					<li><a href="cap02.html#san" target="_self">Storage Area Networks</a></li>
				</ul>

				<li><a href="cap02.html#diagnostico" target="_self">Diagnosticando problemas de E/S de disco</a></li>

				<li><a href="cap02.html#problemas" target="_self">Problemas Comuns de E/S de Disco</a></li>

				<ul class="n2">
					<li><a href="cap02.html#dimensao" target="_self">Dimensionamento para capacidade em vez de desempenho de E/S</a></li>
					<li><a href="cap02.html#isolamento" target="_self">Isolamento incorreto da carga de trabalho</a></li>
					<li><a href="cap02.html#alinhamento" target="_self">Alinhamento incorreto de partições</a></li>
					<li><a href="cap02.html#banda" target="_self">Banda larga incorreta usando configurações SAN</a></li>
				</ul>

				<li><a href="cap02.html#resumo" target="_self">Resumo</a></li>
			</ul>

			<li class="cap"><a href="cap03.html" target="_self" class="cap">Capítulo 3: Utilização Elevada da CPU</a></li>

			<ul class="n1">
				<li><a href="cap03.html#investigando" target="_self">Investigando a Pressão da CPU</a></li>

				<ul class="n2">
					<li><a href="cap03.html#performance" target="_self">Performance Monitor</a></li>
					<li><a href="cap03.html#trace" target="_self">SQL Trace</a></li>
					<li><a href="cap03.html#dmv" target="_self">Dynamic Management Views (DMVs)</a></li>
				</ul>

				<li><a href="cap03.html#causas" target="_self">Causas comuns de alto uso de CPU</a></li>
				<ul class="n2">
					<li><a href="cap03.html#indices" target="_self">Índices ausentes</a></li>
					<li><a href="cap03.html#estatisticas" target="_self">Estatísticas desatualizadas</a></li>
					<li><a href="cap03.html#predicados" target="_self">Predicados não-SARGáveis</a></li>
					<li><a href="cap03.html#conversoes" target="_self">Conversões implícitas</a></li>
					<li><a href="cap03.html#sniffing" target="_self">Parameter sniffing</a></li>
					<li><a href="cap03.html#consultas" target="_self">Consultas não parametrizadas ad hoc</a></li>
					<li><a href="cap03.html#inadequado" target="_self">Paralelismo inadequado</a></li>
					<li><a href="cap03.html#token" target="_self">TokenAndPermUserStore</a></li>
					<li><a href="cap03.html#economia" target="_self">Opções de economia de energia do Windows Server e BIOS</a></li>
				</ul>

				<li><a href="cap03.html#resumo" target="_self">Resumo</a></li>

				<li><a href="cap03.html#recursos" target="_self">Recursos Adicionais</a></li>
			</ul>

			<li class="cap"><a href="cap04.html" target="_self" class="cap">Capítulo 4: Gerenciamento de Memória</a></li>
			
			<ul class="n1">
				<li><a href="cap04.html#motor" target="_self">O Motor de Banco de Dados Autoajustável</a></li>
				<li><a href="cap04.html#aloca" target="_self">Como o SQL Server Aloca Memória</a></li>
				<ul class="n2">
					<li><a href="cap04.html#limitacoes" target="_self">Limitações do Espaço de Endereço Virtual de 32 bits</a></li>
					<li><a href="cap04.html#64bit" target="_self">Usando o SQL Server de 64 bits</a></li>
					<li><a href="cap04.html#opcoes" target="_self">Opções de configuração de memória com o SQL Server de 64 bits</a></li>
				</ul>
				<li><a href="cap04.html#pressao" target="_self">Diagnosticando Pressão de Memória</a></li>
				<ul class="n2">
					<li><a href="cap04.html#crm" target="_self">Contadores relacionados à memória</a></li>
					<li><a href="cap04.html#dmvs" target="_self">DMVs relacionadas à memória</a></li>
				</ul>
				<li><a href="cap04.html#pcrm" target="_self">Problemas comuns relacionados à memória</a></li>
				<ul class="n2">
					<li><a href="cap04.html#mito" target="_self">O mito do vazamento de memória no SQL Server</a></li>
					<li><a href="cap04.html#paginacao" target="_self">Problemas de paginação</a></li>
					<li><a href="cap04.html#instabilidade" target="_self">Instabilidade do sistema operacional devido ao "Lock Pages in Memory" e "max server memory" ilimitado</a></li>
					<li><a href="cap04.html#appdomain" target="_self">App Domain está marcado para descarregar devido à pressão de memória</a></li>
					<li><a href="cap04.html#701" target="_self">Erro 701 e FAILED_VIRTUAL_RESERVE</a></li>
					<li><a href="cap04.html#vmsuper" target="_self">Máquinas virtuais superprovisionadas</a></li>
					<li><a href="cap04.html#vinst" target="_self">Configurações de memória para várias instâncias</a></li>
				</ul>
				<li><a href="cap04.html#resumo" target="_self">Resumo</a></li>
			</ul>

			<li class="cap"><a href="cap05.html" target="_self" class="cap">Capítulo 5: Índices Ausentes</a></li>
			<ul class="n1">
				<li><a href="cap05.html#selecaodesign" target="_self">Seleção e Design de Índices</a></li>
				<ul class="n2">
					<li><a href="cap05.html#colunachave" target="_self">Ordem das Colunas-Chave do Índice</a></li>
					<li><a href="cap05.html#colunasincluidas" target="_self">Uso de colunas incluídas</a></li>
					<li><a href="cap05.html#larguraidx" target="_self">Largura do índice</a></li>
				</ul>
				<li><a href="cap05.html#idxausentes" target="_self">Identificando de índices ausentes</a></li>
				<ul class="n2">
					<li><a href="cap05.html#workload" target="_self">Análise de carga de trabalho com o Database Engine Tuning Advisor</a></li>
					<li><a href="cap05.html#featidxausente" target="_self">Recurso de índices ausentes</a></li>
					<li><a href="cap05.html#iafk" target="_self">Índices ausentes em chaves estrangeiras</a></li>
				</ul>
				<li><a href="cap05.html#unusedidx" target="_self">Identificando Índices Não Utilizados</a></li>
				<li><a href="cap05.html#idxdup" target="_self">Identificando Índices Duplicados</a></li>
				<li><a href="cap05.html#resumo" target="_self">Resumo</a></li>
			</ul>

			<li class="cap"><a href="cap06.html" target="_self" class="cap">Capítulo 6: Bloqueios</a></li>
			<ul class="n1">
				<li><a href="cap06.html#blockconcor" target="_self">Bloqueios e Concorrência (uma Breve Revisão)</a></li>
				<ul class="n2">
					<li><a href="cap06.html#lockmode" target="_self">Modos de Bloqueio</a></li>
					<li><a href="cap06.html#locktype" target="_self">Tipos de bloqueio</a></li>
					<li><a href="cap06.html#lockscalation" target="_self">Escalada de Bloqueio</a></li>
					<li><a href="cap06.html#concurisolation" target="_self">Concorrência e os níveis de isolamento de transações</a></li>
					<li><a href="cap06.html#latches" target="_self">Latches e conteção de latches</a></li>
				</ul>
				<li><a href="cap06.html#lockmon">Monitoramento de Bloqueio</a></li>
				<ul class="n2">
					<li><a href="cap06.html#usesysproc" target="_self">Usando sysprocesses (SQL Server 2000 e posterior)</a></li>
					<li><a href="cap06.html#SQLPERF" target="_self">Estatísticas acumulativas de espera com DBCC SQLPERF (waitstats)</a></li>
					<li><a href="cap06.html#dmvs" target="_self">Visões de Gerenciamento Dinâmico (DMVs)</a></li>
					<li>Performance Monitor</li>
				</ul>
				<li>Automated Detection and Notification of Blocking</li>
				<ul class="n2">
					<li>The Sp_blocker_pss80 process</li>
					<li>SQL Trace</li>
					<li>Event notifications</li>
					<li>Extended Events</li>
				</ul>
				<li>Resolving Blocking</li>
				<ul class="n2">
					<li>Bad database design</li>
					<li>Inappropriate isolation level</li>
					<li>Poorly written queries</li>
					<li>Missing indexes</li>
					<li>Poor application design</li>
					<li>Outdated hardware</li>
				</ul>
				<li>Hints, Trace Flags and Other Last Resorts</li>
				<ul class="n2">
					<li>Locking hints</li>
				</ul>
				<li>Summary</li>
			</ul>

			<li class="cap">Chapter 7: Handling Deadlocks</li>
			<ul class="n1">
				<li>The Lock Monitor</li>
				<li>Capturing Deadlock Graphs</li>
				<ul class="n2">
					<li>Trace Flag 1204</li>
					<li>Trace Flag 1222</li>
					<li>SQL Profiler XML Deadlock Graph event</li>
					<li>Service Broker event notifications</li>
					<li>WMI Provider for server events</li>
					<li>Extended Events</li>
				</ul>
				<li>Reading Deadlock Graphs</li>
				<ul class="n2">
					<li>Interpreting Trace Flag 1204 deadlock graphs</li>
					<li>Interpreting Trace Flag 1222 deadlock graphs</li>
					<li>Interpreting XML deadlock graphs</li>
				</ul>
				<li>Common types of deadlock and how to eliminate them</li>
				<ul class="n2">
					<li>Bookmark lookup deadlock</li>
					<li>Range scans caused by SERIALIZABLE isolation</li>
					<li>Cascading constraint deadlocks</li>
					<li>Intra-query parallelism deadlocks</li>
					<li>Accessing objects in different orders</li>
				</ul>
				<ul class="n2">
					<li>Handling Deadlocks to Prevent Errors</li>
					<li>T-SQL TRY…CATCH blocks</li>
					<li>Handling ADO.NET SqlExceptions in .NET code</li>
				</ul>
				<li>Controlling Deadlock Behavior with Deadlock Priority</li>
				<li>Summary</li>
			</ul>

			<li class="cap">Chapter 8: Large or Full Transaction Log</li>
			<ul class="n1">
				<li>How the Transaction Log Works</li>
				<ul class="n2">
					<li>How SQL Server writes to the transaction log</li>
					<li>Understanding log truncation</li>
					<li>Sizing and growing the log</li>
				</ul>
				<li>Diagnosing a Runaway Transaction Log</li>
				<ul class="n2">
					<li>Excessive logging: index maintenance operations</li>
					<li>Lack of log space reuse</li>
					<li>Other possible causes of log growth</li>
				</ul>
				<li>Handling a "Transaction Log Full" Error</li>
				<li>Mismanagement or What Not To Do</li>
				<li>Detach database, delete log file</li>
				<li>Forcing log file truncation</li>
				<li>Scheduled shrinking of the transaction log</li>
				<li>Proper Log Management</li>
				<li>Summary</li>
			</ul>

			<li class="cap">Chapter 9: Truncated Tables, Dropped Objects and Other Accidents Waiting to Happen</li>
			<ul class="n1">
				<li>Example Case: The Missing Sales Order Data</li>
				<li>Recovering Lost Data</li>
				<ul class="n2">
					<li>Recovering from backup</li>
					<li>Recovering without a backup</li>
				</ul>
				<li>Finding the Culprit</li>
				<li>Prevention is Better than Cure</li>
				<ul class="n2">
					<li>Plan for recovery from all data losses</li>
					<li>Implement a change control process</li>
					<li>Implement an appropriate security model</li>
					<li>Access control measures</li>
				</ul>
				<li>Summary</li>
			</ul>

			<li class="cap">Appendix: What to Do When All Else Fails</li>
			<ul class="n1">
				<li>Microsoft Customer Support Services</li>
				<li>Online Resources</li>
				<ul class="n2">
					<li>Articles</li>
					<li>Blogs</li>
					<li>Forums</li>
				</ul>
				<li>Hiring a Consultant</li>
			</ul>
		</ul>

	</main>
	<footer>
		<p>Criado por Agnaldo Mota</p>
	</footer>
	<script src="scripts/script.js"></script>
</body>
</html>